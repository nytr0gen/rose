function getTpl(t){var e;return $.ajax({url:_url+"template/mustache/"+t+".mustache",dataType:"html",async:!1}).done(function(t){e=t}),e}function getPosts(t){var e=0,a=0,n=null,o=function(){$(".post-list-meta").hover(function(){$(".reading-time",this).toggle(),$(".bookmark",this).toggle()}).click(function(){var t=$(this);$.ajax({url:_url+"action/bookmark",data:{id:t.data("id")}}).done(function(e){1==e.bookmarked?t.addClass("bookmark-set"):t.removeClass("bookmark-set")})})},s=function(){a||(a=1,$.ajax({url:_url+"action/"+t,data:{username:_username,offset:e}}).done(function(t){t.status&&($(".post-list").appendTpl(n,t),o(),a=0,e++)}))},l=function(){var t=window.innerHeight?window.innerHeight:$(window).height(),e=$(window).scrollTop()+t>$(document).height()-100;e&&s()};_username="undefined"!=typeof _username?_username:-1,n=getTpl("postList"),Mustache.parse(n),s(),$(window).bind("scroll.post-list",l)}$.ajaxSetup({type:"POST",dataType:"json",cache:!1}),$("[contenteditable=true][data-placeholder]").html(function(t,e){""==e&&$(this).addClass("js-placeholder").html($(this).data("placeholder"))}).focus(function(){$(this).html()==$(this).data("placeholder")&&$(this).removeClass("js-placeholder").html("")}).blur(function(){""==$(this).html()&&$(this).addClass("js-placeholder").html($(this).data("placeholder"))}),$.fn.appendTpl=function(t,e){e.siteUrl=_url,$(this).append(Mustache.render(t,e))},$(".msg-close").on("click",function(){$(".msg").fadeOut()});